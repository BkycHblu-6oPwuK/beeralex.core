# ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Core (beeralex.core)

Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğ¹ Ğ¼Ğ¾Ğ´ÑƒĞ»ÑŒ Ğ´Ğ»Ñ Ñ€Ğ°Ğ·Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ¸ Bitrix-Ğ¿Ñ€Ğ¸Ğ»Ğ¾Ğ¶ĞµĞ½Ğ¸Ğ¹ Ñ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¼ Ğ¿Ğ¾Ğ´Ñ…Ğ¾Ğ´Ğ¾Ğ¼ Ğº Ğ°Ñ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğµ. ĞŸÑ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ¸Ğ½ÑÑ‚Ñ€ÑƒĞ¼ĞµĞ½Ñ‚Ñ‹ Ğ´Ğ»Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹ Ñ Ğ¸Ğ½Ñ„Ğ¾Ğ±Ğ»Ğ¾ĞºĞ°Ğ¼Ğ¸, Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸ÑĞ¼Ğ¸, ÑĞµÑ€Ğ²Ğ¸ÑĞ°Ğ¼Ğ¸, ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ğ°Ğ¼Ğ¸ Ğ¸ Ğ¼Ğ½Ğ¾Ğ³Ğ¾Ğµ Ğ´Ñ€ÑƒĞ³Ğ¾Ğµ.

[![PHP](https://img.shields.io/badge/PHP-8.1+-blue.svg)](https://www.php.net/)
[![Bitrix](https://img.shields.io/badge/Bitrix-14.0.0+-orange.svg)](https://www.bitrix24.ru/)

## Ğ’Ğ¾Ğ·Ğ¼Ğ¾Ğ¶Ğ½Ğ¾ÑÑ‚Ğ¸

- ğŸ¯ **Dependency Injection** - Ğ£Ğ¿Ñ€Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ Ğ·Ğ°Ğ²Ğ¸ÑĞ¸Ğ¼Ğ¾ÑÑ‚ÑĞ¼Ğ¸ Ñ‡ĞµÑ€ĞµĞ· DI-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
- ğŸ“¦ **Repository Pattern** - Ğ£Ğ´Ğ¾Ğ±Ğ½Ğ°Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸ (Ğ¸Ğ½Ñ„Ğ¾Ğ±Ğ»Ğ¾ĞºĞ¸, Ñ…Ğ°Ğ¹Ğ»Ğ¾Ğ°Ğ´-Ğ±Ğ»Ğ¾ĞºĞ¸)
- âš™ï¸ **Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹** - Ğ“Ğ¾Ñ‚Ğ¾Ğ²Ñ‹Ğµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ Ğ´Ğ»Ñ Ñ‚Ğ¸Ğ¿Ğ¾Ğ²Ñ‹Ñ… Ğ·Ğ°Ğ´Ğ°Ñ‡
- ğŸ® **ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹** - Ğ‘Ğ°Ğ·Ğ¾Ğ²Ñ‹Ğµ ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹ Ñ Ğ°Ğ²Ñ‚Ğ¾Ğ²Ğ°Ğ»Ğ¸Ğ´Ğ°Ñ†Ğ¸ĞµĞ¹
- ğŸ”§ **ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ** - Ğ¢Ğ¸Ğ¿Ğ¾Ğ±ĞµĞ·Ğ¾Ğ¿Ğ°ÑĞ½Ğ°Ñ ÑĞ¸ÑÑ‚ĞµĞ¼Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº
- ğŸ“ **Logger** - PSR-3 ÑĞ¾Ğ²Ğ¼ĞµÑÑ‚Ğ¸Ğ¼Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
- ğŸš€ **Vite Integration** - Ğ˜Ğ½Ñ‚ĞµĞ³Ñ€Ğ°Ñ†Ğ¸Ñ Ñ ÑĞ¾Ğ²Ñ€ĞµĞ¼ĞµĞ½Ğ½Ñ‹Ğ¼ Ñ„Ñ€Ğ¾Ğ½Ñ‚ĞµĞ½Ğ´Ğ¾Ğ¼

## Ğ‘Ñ‹ÑÑ‚Ñ€Ñ‹Ğ¹ ÑÑ‚Ğ°Ñ€Ñ‚

### Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ°

Ğ”Ğ¾Ğ±Ğ°Ğ²ÑŒÑ‚Ğµ Ğ² `composer.json` Ğ½Ğ°ÑÑ‚Ñ€Ğ¾Ğ¹ĞºÑƒ Ğ´Ğ»Ñ ÑƒÑÑ‚Ğ°Ğ½Ğ¾Ğ²ĞºĞ¸ Ğ² `local/modules` (Ğ¸Ğ»Ğ¸ Ğ² bitrix, ÑÑ‚Ğ¾ Ğ½Ğ° Ğ²Ğ°ÑˆĞµ ÑƒÑĞ¼Ğ¾Ñ‚Ñ€ĞµĞ½Ğ¸Ğµ):

```json
{
  "extra": {
    "installer-paths": {
      "local/modules/{$name}/": ["type:bitrix-module"]
    }
  }
}
```

Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚Ğµ Ğ¿Ğ°ĞºĞµÑ‚:

```bash
composer require beeralex/beeralex.core
```

### ĞĞºÑ‚Ğ¸Ğ²Ğ°Ñ†Ğ¸Ñ

Ğ’ Ğ°Ğ´Ğ¼Ğ¸Ğ½ĞºĞµ: `Marketplace -> Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ»ĞµĞ½Ğ½Ñ‹Ğµ Ñ€ĞµÑˆĞµĞ½Ğ¸Ñ -> Ğ£ÑÑ‚Ğ°Ğ½Ğ¾Ğ²Ğ¸Ñ‚ÑŒ`

Ğ˜ Ğ² `/local/php_interface/init.php`:

```php
\Bitrix\Main\Loader::includeModule('beeralex.core');
```

### ĞŸĞµÑ€Ğ²Ñ‹Ğ¹ ĞºĞ¾Ğ´

```php
use Beeralex\Core\Repository\IblockRepository;
use Beeralex\Core\Service\UserService;

// Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ñ€ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸ÑĞ¼Ğ¸
$newsRepo = new IblockRepository('news');
$news = $newsRepo->getList(['ACTIVE' => 'Y']);

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ²
$userService = service(UserService::class);
$password = $userService->generatePassword([2]);
```

## Ğ¤ÑƒĞ½ĞºÑ†Ğ¸Ğ¸-Ñ…ĞµĞ»Ğ¿ĞµÑ€Ñ‹

ĞœĞ¾Ğ´ÑƒĞ»ÑŒ Ğ¿Ñ€ĞµĞ´Ğ¾ÑÑ‚Ğ°Ğ²Ğ»ÑĞµÑ‚ Ğ³Ğ»Ğ¾Ğ±Ğ°Ğ»ÑŒĞ½Ñ‹Ğµ Ñ„ÑƒĞ½ĞºÑ†Ğ¸Ğ¸-Ğ¿Ğ¾Ğ¼Ğ¾Ñ‰Ğ½Ğ¸ĞºĞ¸ Ğ´Ğ»Ñ ÑƒĞ¿Ñ€Ğ¾Ñ‰ĞµĞ½Ğ¸Ñ Ñ€Ğ°Ğ±Ğ¾Ñ‚Ñ‹:

### service()

ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑĞ° Ğ¸Ğ· DI-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ° Ñ Ğ¿Ğ¾Ğ´Ğ´ĞµÑ€Ğ¶ĞºĞ¾Ğ¹ Ñ‚Ğ¸Ğ¿Ğ¸Ğ·Ğ°Ñ†Ğ¸Ğ¸:

```php
// ĞĞ²Ñ‚Ğ¾Ğ¼Ğ°Ñ‚Ğ¸Ñ‡ĞµÑĞºĞ¾Ğµ Ğ¾Ğ¿Ñ€ĞµĞ´ĞµĞ»ĞµĞ½Ğ¸Ğµ Ñ‚Ğ¸Ğ¿Ğ° Ğ±Ğ»Ğ°Ğ³Ğ¾Ğ´Ğ°Ñ€Ñ @template
$userService = service(UserService::class);
$logger = service(LoggerFactoryContract::class);
```

### firstNotEmpty()

Ğ’Ğ¾Ğ·Ğ²Ñ€Ğ°Ñ‰Ğ°ĞµÑ‚ Ğ¿ĞµÑ€Ğ²Ğ¾Ğµ Ğ½ĞµĞ¿ÑƒÑÑ‚Ğ¾Ğµ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¸Ğ»Ğ¸ Ğ·Ğ½Ğ°Ñ‡ĞµĞ½Ğ¸Ğµ Ğ¿Ğ¾ ÑƒĞ¼Ğ¾Ğ»Ñ‡Ğ°Ğ½Ğ¸Ñ:

```php
$value = firstNotEmpty('default', $var1, $var2, $var3);
// Ğ’ĞµÑ€Ğ½ĞµÑ‚ Ğ¿ĞµÑ€Ğ²Ğ¾Ğµ Ğ½ĞµĞ¿ÑƒÑÑ‚Ğ¾Ğµ Ğ¸Ğ· $var1, $var2, $var3 Ğ¸Ğ»Ğ¸ 'default'
```

### toFile()

Ğ‘Ñ‹ÑÑ‚Ñ€Ğ¾Ğµ Ğ»Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ğ² Ñ„Ğ°Ğ¹Ğ» (Ğ´Ğ»Ñ Ğ¾Ñ‚Ğ»Ğ°Ğ´ĞºĞ¸):

```php
toFile($data); // Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ² default.log
toFile(['user_id' => 123, 'action' => 'login']); // Ğ›Ğ¾Ğ³Ğ¸Ñ€ÑƒĞµÑ‚ Ğ¼Ğ°ÑÑĞ¸Ğ²
```

### coreLog()

Ğ›Ğ¾Ğ³Ğ¸Ñ€Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ Ñ‡ĞµÑ€ĞµĞ· Ğ²ÑÑ‚Ñ€Ğ¾ĞµĞ½Ğ½ÑƒÑ ÑĞ¸ÑÑ‚ĞµĞ¼Ñƒ Bitrix:

```php
coreLog('Ğ¡Ğ¾Ğ¾Ğ±Ñ‰ĞµĞ½Ğ¸Ğµ Ğ¾Ğ± Ğ¾ÑˆĞ¸Ğ±ĞºĞµ');
coreLog('Ğ”ĞµÑ‚Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ¸Ğ½Ñ„Ğ¾Ñ€Ğ¼Ğ°Ñ†Ğ¸Ñ', 10, true); // Ğ¡ Ñ‚Ñ€Ğ°ÑÑĞ¸Ñ€Ğ¾Ğ²ĞºĞ¾Ğ¹ Ğ¸ Ğ°Ñ€Ğ³ÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ğ¼Ğ¸
```

### isLighthouse()

ĞĞ¿Ñ€ĞµĞ´ĞµĞ»ÑĞµÑ‚, ÑĞ²Ğ»ÑĞµÑ‚ÑÑ Ğ»Ğ¸ Ğ·Ğ°Ğ¿Ñ€Ğ¾Ñ Ğ¾Ñ‚ Google Lighthouse:

```php
if (isLighthouse()) {
    // Ğ¡Ğ¿ĞµÑ†Ğ¸Ğ°Ğ»ÑŒĞ½Ğ°Ñ Ğ»Ğ¾Ğ³Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ°ÑƒĞ´Ğ¸Ñ‚Ğ° Ğ¿Ñ€Ğ¾Ğ¸Ğ·Ğ²Ğ¾Ğ´Ğ¸Ñ‚ĞµĞ»ÑŒĞ½Ğ¾ÑÑ‚Ğ¸
}
```

### isImport()

ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚, Ğ¸Ğ´ĞµÑ‚ Ğ»Ğ¸ Ğ¾Ğ±Ğ¼ĞµĞ½ Ñ 1Ğ¡:

```php
if (isImport()) {
    // Ğ›Ğ¾Ğ³Ğ¸ĞºĞ° Ğ´Ğ»Ñ Ğ¸Ğ¼Ğ¿Ğ¾Ñ€Ñ‚Ğ° Ğ¸Ğ· 1Ğ¡
}
```

### isCli()

ĞŸÑ€Ğ¾Ğ²ĞµÑ€ÑĞµÑ‚ Ğ·Ğ°Ğ¿ÑƒÑ‰ĞµĞ½ Ğ»Ğ¸ ÑĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ¸Ğ· Ğ¿Ğ¾Ğ´ cli

```php
if (isCli()) {
    // Ğ¡ĞºÑ€Ğ¸Ğ¿Ñ‚ Ğ²Ñ‹Ğ¿Ğ¾Ğ»Ğ½ÑĞµÑ‚ÑÑ Ğ¸Ğ· Ğ¿Ğ¾Ğ´ cli
}
```

## Ğ”Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ

ğŸ“š **[ĞŸĞ¾Ğ»Ğ½Ğ°Ñ Ğ´Ğ¾ĞºÑƒĞ¼ĞµĞ½Ñ‚Ğ°Ñ†Ğ¸Ñ](./docs/README.md)**

- [Dependency Injection](./docs/dependency-injection.md) - DI ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€
- [Ğ ĞµĞ¿Ğ¾Ğ·Ğ¸Ñ‚Ğ¾Ñ€Ğ¸Ğ¸](./docs/repositories.md) - Ğ Ğ°Ğ±Ğ¾Ñ‚Ğ° Ñ Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼Ğ¸
- [Ğ¡ĞµÑ€Ğ²Ğ¸ÑÑ‹](./docs/services.md) - Ğ’ÑĞµ ÑĞµÑ€Ğ²Ğ¸ÑÑ‹ Ğ¼Ğ¾Ğ´ÑƒĞ»Ñ
- [ĞšĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹](./docs/controllers.md) - HTTP ĞºĞ¾Ğ½Ñ‚Ñ€Ğ¾Ğ»Ğ»ĞµÑ€Ñ‹
- [ĞšĞ¾Ğ½Ñ„Ğ¸Ğ³ÑƒÑ€Ğ°Ñ†Ğ¸Ñ](./docs/configuration.md) - Ğ¡Ğ¸ÑÑ‚ĞµĞ¼Ğ° Ğ½Ğ°ÑÑ‚Ñ€Ğ¾ĞµĞº

## ĞŸÑ€Ğ¸Ğ¼ĞµÑ€Ñ‹ Ğ¸ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

### Repository Pattern

```php
use Beeralex\Core\Repository\IblockRepository;

$newsRepo = new IblockRepository('news');

// ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ Ğ´Ğ°Ğ½Ğ½Ñ‹Ñ… Ñ Ñ„Ğ¸Ğ»ÑŒÑ‚Ñ€Ğ¾Ğ¼ Ğ¸ ÑĞ¾Ñ€Ñ‚Ğ¸Ñ€Ğ¾Ğ²ĞºĞ¾Ğ¹
$items = $newsRepo->getList(
    ['ACTIVE' => 'Y'],
    [
        'select' => ['ID', 'NAME', 'DATE_CREATE'],
        'order' => ['DATE_CREATE' => 'DESC'],
        'limit' => 10
    ]
);

// Ğ”Ğ¾Ğ±Ğ°Ğ²Ğ»ĞµĞ½Ğ¸Ğµ ÑĞ»ĞµĞ¼ĞµĞ½Ñ‚Ğ°
$id = $newsRepo->add([
    'NAME' => 'ĞĞ¾Ğ²Ğ¾ÑÑ‚ÑŒ',
    'ACTIVE' => 'Y',
    'PROPERTY_VALUES' => [
        'CATEGORY' => 5
    ]
]);
```

### Dependency Injection

```php
use Beeralex\Core\Service\FileService;
use Beeralex\Core\Service\PaginationService;

// ĞŸĞ¾Ğ»ÑƒÑ‡ĞµĞ½Ğ¸Ğµ ÑĞµÑ€Ğ²Ğ¸ÑĞ¾Ğ² Ğ¸Ğ· DI-ĞºĞ¾Ğ½Ñ‚ĞµĞ¹Ğ½ĞµÑ€Ğ°
$fileService = service(FileService::class);
$paginationService = service(PaginationService::class);

// Ğ˜ÑĞ¿Ğ¾Ğ»ÑŒĞ·Ğ¾Ğ²Ğ°Ğ½Ğ¸Ğµ
$fileService->includeFile('catalog.index', ['productId' => 123]);
$pages = $paginationService->getPages(1, 10);
```

### API Controller

```php
use Beeralex\Core\Http\Controllers\ApiController;

class ProductController extends ApiController
{
    public function listAction(int $limit = 10): array
    {
        $repository = new IblockRepository('catalog');
        
        return [
            'items' => $repository->getList(
                ['ACTIVE' => 'Y'],
                ['limit' => $limit]
            )
        ];
    }
}
```

## ĞÑ€Ñ…Ğ¸Ñ‚ĞµĞºÑ‚ÑƒÑ€Ğ°

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Controllers (HTTP)            â”‚  <- ĞĞ±Ñ€Ğ°Ğ±Ğ¾Ñ‚ĞºĞ° Ğ·Ğ°Ğ¿Ñ€Ğ¾ÑĞ¾Ğ²
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Services (Business Logic)     â”‚  <- Ğ‘Ğ¸Ğ·Ğ½ĞµÑ-Ğ»Ğ¾Ğ³Ğ¸ĞºĞ°
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Repositories (Data Access)    â”‚  <- Ğ”Ğ¾ÑÑ‚ÑƒĞ¿ Ğº Ğ´Ğ°Ğ½Ğ½Ñ‹Ğ¼
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚   Models/Entities               â”‚  <- Ğ”Ğ°Ğ½Ğ½Ñ‹Ğµ
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

## Ğ¢Ñ€ĞµĞ±Ğ¾Ğ²Ğ°Ğ½Ğ¸Ñ

- PHP >= 8.1
- 1Ğ¡-Ğ‘Ğ¸Ñ‚Ñ€Ğ¸ĞºÑ >= 14.0.0
- Composer

## Ğ›Ğ¸Ñ†ĞµĞ½Ğ·Ğ¸Ñ

MIT

## ĞĞ²Ñ‚Ğ¾Ñ€

Alexandr Belotsitsko (sanyabelyy020@gmail.com)
